<%-include("../users/layout/header.ejs")%>
<main>
    <form  action="/addAddress" method="post" class="needs-validation modal fade"  id="add-address" tabindex="-1" novalidate>
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Add a new address</h5>
              <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="row gx-4 gy-3">
                <div class="col-sm-6">
                    <label class="form-label" for="address-line1">First Name</label>
                    <input class="form-control" name="fname" type="text" id="address-line1" required>
                    <div class="invalid-feedback">Please fill in first Name!</div>
                  </div>  <div class="col-sm-6">
                    <label class="form-label" for="address-line1">Lst Name</label>
                    <input class="form-control" name="lname" type="text" id="address-line1" required>
                    <div class="invalid-feedback">Please fill in last name!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-line1">Phone Number</label>
                    <input class="form-control" name="phNumber" type="text" id="address-line1" required>
                    <div class="invalid-feedback">Please fill in phone number!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-line1">Your Home Address</label>
                    <input class="form-control" name="homeAdd" type="text" id="address-line1" required>
                    <div class="invalid-feedback">Please fill in your address!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-line1">Your Locality</label>
                    <input class="form-control" name="locality" type="text" id="address-line1" required>
                    <div class="invalid-feedback">Please fill in your address!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-city">Home Town</label>
                    <input class="form-control" name="homeTown" type="text" id="address-city" required>
                    <div class="invalid-feedback">Please fill in your Home Town!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-city">City</label>
                    <input class="form-control" name="city" type="text" id="address-city" required>
                    <div class="invalid-feedback">Please fill in your city!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-country">State</label>
                    <select class="form-select" name="state" id="address-country" required>
                      <option value>Select State</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Goa">Goa</option>
                      <option value="Andhra Pradesh">Andhra Pradesh</option>
                    </select>
                    <div class="invalid-feedback">Please select your state!</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label" for="address-country">Country</label>
                    <select class="form-select" name="country"id="address-country" required>
                      <option value>Select country</option>
                      <option value="India">INDIA</option>
                    </select>
                    <div class="invalid-feedback">Please select your country!</div>
                  </div>
                <div class="col-sm-6">
                  <label class="form-label" for="address-zip">PIN code</label>
                  <input class="form-control" name="pinCode" type="text" id="address-zip" required>
                  <div class="invalid-feedback">Please add your PIN code!</div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">Close</button>
              <button class="btn btn-primary btn-shadow" type="submit">Add address</button>
            </div>
          </div>
        </div>
      </form>
    <div class="page-title-overlap bg-dark pt-4">
        <div class="container d-lg-flex justify-content-between py-2 py-lg-3">
          <div class="order-lg-2 mb-3 mb-lg-0 pt-lg-2">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb breadcrumb-light flex-lg-nowrap justify-content-center justify-content-lg-start">
                <li class="breadcrumb-item"><a class="text-nowrap" href="/"><i class="ci-home"></i>Home</a></li>
              </ol>
            </nav>
          </div>
          <div class="order-lg-1 pe-lg-4 text-center text-lg-start">
            <h1 class="h3 text-light mb-0">Address</h1>
          </div>
        </div>
      </div>
      <div class="container pb-5 mb-2 mb-md-4">
        <div class="row">
          <!-- Sidebar-->
<%-include("../users/layout/shopheader.ejs") %>
    <section class="col-lg-8">
    <section class=" container-fluid ">
        <!-- Toolbar-->
        
        <div class="d-none d-lg-flex justify-content-between align-items-center pt-lg-3 pb-4 pb-lg-5 mb-lg-3">
          <h6 class="fs-base text-light mb-0">List of your registered addresses:</h6><a class="btn btn-primary btn-sm" href="/userLogout"><i class="ci-sign-out me-2"></i>Sign out</a>
        </div>
        <!-- Addresses list-->
        <div class="table-responsive fs-md">
    
          <table class="table table-hover mb-0">
            <thead>
              <tr>
                <th>Address</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
                <%userDetails.address.forEach((userDetails,i)=>{%>
                    <tr>
                        <td class="py-3 align-middle"><%=userDetails.fname%> , <%=userDetails.lname%> , <%=userDetails.phone%> , <%=userDetails.house%>,<%=userDetails.locality%>, <%=userDetails.hometown%> , <%=  userDetails.city%> , <%=userDetails.state%> , <%=userDetails.country%> , <%=userDetails.pin%></td>
                        <td class="py-3 align-middle"><a class="nav-link-style text-danger" onclick="deleteaddress('<%=userDetails._id%>')" data-bs-toggle="tooltip" title="Remove">
                            <div class="ci-trash"></div></a></td>
                      </tr>
                <%}); %>
             
            </tbody>
          </table>
        </div>
        <div class="text-sm-end pt-4"><a class="btn btn-primary" href="#add-address" data-bs-toggle="modal">Add new address</a></div>
      </section>
    </div>
</div>
</main>
<script>
   function deleteaddress(addressId){
    console.log(addressId);
        $.ajax({
            url:'/deleteAddress',
            data:{
                addressId:addressId
            },
            method:'post',
            success:(response)=>{

            }
        }).done((data)=>{
            console.log(data);
            if(data.success){
                location.reload()
            }
        })
    }
</script>
<%-include("../users/layout/footer.ejs") %>