<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</head>
<body style="margin: 12px;">
  
<div style="width: 100%; height: 100%;"> 
<div class="d-flex justify-content-center align-items-center" style="width: 100%;">
  <h2> <i> <b>Sales Report</b></i> </h2>
    <% if (typeof fromDate != '' && toDate != '') {%>
        <h4 style="color: rgb(126, 126, 126);"> From <%= fromDate %> To <%= toDate %> </h4>
    <% } else { %>
        <h4>All delivered Orders</h4>
    <% } %>
</div>
<div class="d-flex justify-content-center" style="width: 100%; height: 100%;">
    <table class="table" style="width: 100%;border: solid rgb(172, 172, 172)   1px;"> 
        <thead style="border-bottom: solid rgb(172, 172, 172) 1px;">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Order id</th>
            <th scope="col">Customer Name</th>
            <th scope="col">Ordered Products</th>
            <th scope="col">Ordered Date</th>
            <th scope="col">Subtotal</th>
            <th scope="col">Payment Method</th>
          </tr>
        </thead>
        <tbody>
            <% order.forEach((element,i) => {%>
                <tr style="border-bottom: solid rgb(172, 172, 172) 1px;">
                    <td scope="row"><%-i+1%></td>
                    <td scope="row"><%=element._id %></td>
                    <td scope="row"><%=element.address.fname%> <%=element.address.lname%></td>
                    <td scope="row"><%=element.date.toLocaleString() %></td>
                    <td scope="row">
                      <% element.products.forEach((orderData,i) => {%>
                        <%=orderData.product.name %>, <br>
                      <% }) %>
                    </td>
                    <td scope="row"><%=element.Subtotal %></td>
                    <td scope="row"><%=element.paymentMethod %></td>
                  </tr>
            <%}); %>
        </tbody>
        </table>
          
    </div>
    <div class="d-flex me-4"  style="width: 100%; ">
      <div class="d-flex" style="margin-left: 750px; margin-top: 25px;">
          <div class="d-flex flex-column">
            <img style="width: 100px; height: auto;" src="https://imgs.search.brave.com/Pk-CGsQ0Um6lwQi8dx31UNKWKOu54mwn4v4e0BVmijo/rs:fit:1005:1008:1/g:ce/aHR0cDovL3d3dy5w/bmdhbGwuY29tL3dw/LWNvbnRlbnQvdXBs/b2Fkcy8yMDE2LzA1/L0NlcnRpZmllZC1T/dGFtcC5wbmc" alt="certified logo">
            <h6 style="padding-top: 10px;"><b> BY :- DigiCart</b></h6>
        </div>
    </div>
    </div>
    </div>
  </body>
</html>
     